// Generated by CoffeeScript 1.7.1
(function() {
  window.toggleSubtitles = function() {
    return $('#subtitle-container').slideToggle({
      duration: 400,
      complete: function() {
        $('subtitle-container').css('display', 'none');
        return util.maintainAspect();
      }
    });
  };

  window.toggleComments = function() {
    console.log('toggle comments');
    return $('#comment-container').slideToggle({
      duration: 400,
      complete: function() {
        $('comment-container').css('display', 'none');
        return util.maintainAspect();
      }
    });
  };

  window.toggleInput = function() {
    timeline.pause();
    $('#inputTextArea').val('');
    console.log('toggle comment input');
    return $('#input-container').animate({
      width: "toggle",
      duration: 400,
      complete: function() {
        if ($('#input-container').css('display') === 'block') {
          return $('#input-container').css('display', 'none');
        } else {
          return $('#input-container').css('display', 'block');
        }
      }
    });
  };

  window.submitInput = function() {
    var comment, text, timestamp, username;
    username = 'testuser';
    timestamp = timeline.currentTimelineURI();
    text = $('#inputTextArea').val();
    comment = {
      username: 'testuser',
      timestamp: timestamp,
      text: text
    };
    $('#input-container').hide();
    return $.ajax({
      type: "POST",
      url: "/comments",
      data: JSON.stringify(comment),
      contentType: "application/json; charset=utf-8",
      dataType: "json",
      success: function() {
        return alert('successful post');
      }
    });
  };

  $(function() {
    var left, reportOnDeck, timeline;
    util.maintainAspect();
    window.sceneController = new lessonplan.SceneController(sceneList);
    timeline = new lessonplan.Timeline('#timeline-controls', window.sceneController);
    if ((window.showSubtitles != null) && window.showSubtitles) {
      window.toggleSubtitles();
    }
    left = 140;
    $('#charactersLeft').text(left);
    $('#inputTextArea').keyup(function() {
      left = 140 - $(this).val().length;
      return $('#charactersLeft').text(left);
    });
    console.log("~~~~~~~~~ REPORT ON DECK ~~~~~~~~~~~~~");
    reportOnDeck = function(ondecks) {
      return console.log(ondecks);
    };
    timeline.onNewOnDeckURIs(reportOnDeck);
    $('#commentButton').on('click', function() {
      var newText;
      newText = $('#commentField').val();
      return $('#comment-container').append('<div class="comment">' + newText + '</div>');
    });
    return window.timeline = timeline;
  });

}).call(this);
